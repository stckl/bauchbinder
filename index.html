<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data:; connect-src 'self' ws://localhost:3000 http://localhost:5001 ws://localhost:5001 http://127.0.0.1:5001 ws://127.0.0.1:5001; worker-src 'self' blob:;">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>mstoeckle bauchbinder</title>
  </head>
  
  <body>
    <div id="app" class="ui fluid container inverted">
      <div class="row">
        <div class="col">
          <button class="ui right floated labeled icon red button" v-on:click="stopLowerthird()">
            <i class="eye slash icon"></i>
            ausblenden
          </button>
          <h2>bauchbinder</h2>
        </div>
      </div>

      <div class="ui divider" style="clear:both; padding-top: 20px;"></div>
      
      <div class="ui pointing secondary menu inverted">
        <a class="item active" data-tab="items">Bauchbinden</a>
        <a class="item" data-tab="design">Gestaltung</a>
        <a class="item" data-tab="animation">Animation</a>
        <a class="item" data-tab="info">Info</a>
      </div>

      <div class="ui tab segment active" data-tab="items">
        <div class="row">
          <div class="col" style="text-align: right;">
            <button class="ui inverted green labeled icon button" v-on:click="showModal">
              <i class="plus icon"></i>
              neue Bauchbinde
            </button>
          </div>
        </div>

        <div class="row" style="margin-top:20px;">
          <div class="col">
            <draggable v-model="lowerthirds" item-key="name" draggable=".card" class="ui cards" @end="onDragEnd">
              <template #item="{element, index}">
                <div class="card inverted" v-bind:class="{ active: (active == index) }">
                  <div class="content">
                    <span class="right floated"><i class="edit icon" v-on:click="showModal(index)"></i> {{index+1}}</span>
                    
                    <div class="header">{{element.name}}</div>
                    <div class="description">
                      {{element.title}}
                    </div>
                  </div>
                  <div class="ui bottom attached green button" v-on:click="playLowerthird(index)">
                    <i class="play icon"></i>
                    anzeigen
                  </div>
                </div>
              </template>
            </draggable>
          </div>        
        </div>
      </div>

      <div class="ui tab segment" data-tab="design">
        <div class="row" style="margin-top: 20px;">
          <div class="col">
            <h2>style</h2>
                        <form class="ui form inverted" v-on:submit.prevent>
                          
                          <h4 class="ui dividing header inverted">Bauchbinde</h4>
                          <div class="fields">
                            <div class="four wide field">
                              <label>Breite (min in %)</label>
                              <div class="ui left icon input">
                                <input type="number" step="0.01" min="0" max="100" v-model="design.white.width" placeholder="Breite">
                                <i class="arrows alternate horizontal icon"></i>
                              </div>
                            </div>
                            <div class="four wide field">
                              <label>Abstand links/rechts (in %)</label>
                              <div class="ui left icon input">
                                <input type="number" step="0.01" min="-100" max="100" v-model="design.white.left" placeholder="Abstand seite">
                                <i class="arrow right icon"></i>
                              </div>
                            </div>
                            <div class="four wide field">
                              <label>Abstand unten (in %)</label>
                              <div class="ui left icon input">
                                <input type="number" step="0.01" min="-100" max="100" v-model="design.white.bottom" placeholder="Abstand unten">
                                <i class="arrow up icon"></i>
                              </div>
                            </div>
                            <div class="four wide field">
                              <color-picker v-model="design.white.color" label="Hintergrundfarbe"></color-picker>
                            </div>
                          </div>
                          <div class="fields">
                            <div class="four wide field">
                              <label>Position</label>
                              <div class="ui icon inverted buttons">
                                <button class="ui button" :class="{ blue: (design.white.divalign == 0) }"  v-on:click.prevent="design.white.divalign = 0">
                                  <i class="align left icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: (design.white.divalign == 1) }"  v-on:click.prevent="design.white.divalign = 1">
                                  <i class="align center icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: (design.white.divalign == 2) }"  v-on:click.prevent="design.white.divalign = 2">
                                  <i class="align right icon"></i>
                                </button>
                              </div>
                            </div>
                            <div class="four wide field">
                              <label>Text Ausrichtung</label>
                              <div class="ui icon inverted buttons">
                                <button class="ui button" :class="{ blue: (design.white.textalign == 0) }"  v-on:click.prevent="design.white.textalign = 0">
                                  <i class="align left icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: (design.white.textalign == 1) }"  v-on:click.prevent="design.white.textalign = 1">
                                  <i class="align center icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: (design.white.textalign == 2) }"  v-on:click.prevent="design.white.textalign = 2">
                                  <i class="align right icon"></i>
                                </button>
                              </div>
                            </div>
              
                            <div class="four wide field">
                              <label>Text Abstand horizontal</label>
                              <div class="ui left icon input">
                                <input type="number" step="0.01" min="0" max="100" v-model="design.white.paddingh" placeholder="Abstand seite">
                                <i class="arrow right icon"></i>
                              </div>
                            </div>
                            <div class="four wide field">
                              <label>Text Abstand vertikal</label>
                              <div class="ui left icon input">
                                <input type="number" step="0.01" min="0" max="100" v-model="design.white.paddingv" placeholder="Abstand unten">
                                <i class="arrow up icon"></i>
                              </div>
                            </div>
                          </div>
                          <div class="fields">
                            <div class="four wide field">
                              <label>Ecken Rundung</label>
                              <div class="ui left icon input">
                                <input type="number" step="1" min="0" max="1000" v-model="design.white.borderradius" placeholder="Ecken Rundung">
                                <i class="square outline icon"></i>
                              </div>
                            </div>
                            <div class="four wide field">
                              <label>Box Überlauf (Box Overflow)</label>
                              <select class="ui inverted dropdown" v-model="design.white.overflow">
                                <option value="hidden">Verstecken (Hidden)</option>
                                <option value="visible">Anzeigen (Visible)</option>
                              </select>
                            </div>
                            <div class="four wide field">
                              <label>Text Überlauf (Text Overflow)</label>
                              <select class="ui inverted dropdown" v-model="design.white.textOverflow">
                                <option value="hidden">Verstecken (Hidden)</option>
                                <option value="visible">Anzeigen (Visible)</option>
                              </select>
                            </div>
                          </div>
                          
                          <h4 class="ui dividing header inverted">Schrift Name</h4>
                          <div class="field">
                            <label>Schriftart</label>
                            <fomantic-dropdown v-model="design.h1.fontfamily" :options="allFonts" :custom-fonts="design.customFonts" :manual-fonts="manualFonts" :system-fonts="systemFonts"></fomantic-dropdown>
                          </div>
                          <div class="fields">
                            <div class="field">
                              <label>Stil</label>
                              <div class="ui icon inverted buttons">
                                <button class="ui button" :class="{ blue: design.h1.bold }"  v-on:click.prevent="toggleH1Bold()">
                                  <i class="bold icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: design.h1.italic }"  v-on:click.prevent="toggleH1Italic()">
                                  <i class="italic icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: design.h1.fontvariant === 'small-caps' }" v-on:click.prevent="toggleH1Variant()" title="Kapitälchen">
                                  <span style="font-variant: small-caps; font-weight: bold;">Aa</span>
                                </button>
                              </div>
                            </div>
                            <div class="field">
                              <label>Umwandlung</label>
                              <div class="ui small basic inverted icon buttons">
                                <button class="ui button" :class="{ blue: design.h1.texttransform === 'none' }" v-on:click.prevent="design.h1.texttransform = 'none'" title="Normal">Aa</button>
                                <button class="ui button" :class="{ blue: design.h1.texttransform === 'uppercase' }" v-on:click.prevent="design.h1.texttransform = 'uppercase'" title="GROSS">AA</button>
                                <button class="ui button" :class="{ blue: design.h1.texttransform === 'lowercase' }" v-on:click.prevent="design.h1.texttransform = 'lowercase'" title="klein">aa</button>
                                <button class="ui button" :class="{ blue: design.h1.texttransform === 'capitalize' }" v-on:click.prevent="design.h1.texttransform = 'capitalize'" title="Erster Groß">Ab</button>
                              </div>
                            </div>
                            <div class="field">
                              <label>Dicke</label>
                              <input type="text" v-model="design.h1.fontweight" placeholder="800" style="width: 80px;">
                            </div>
                            <div class="field">
                              <label>Größe (vh)</label>
                              <input type="number" step="0.1" v-model="design.h1.fontsize" style="width: 80px;">
                            </div>
                            <div class="four wide field">
                              <color-picker v-model="design.h1.color" label="Schriftfarbe Name"></color-picker>
                            </div>
                          </div>
            
                          <h4 class="ui dividing header inverted">Schrift Titel</h4>
                          <div class="field">
                            <label>Schriftart</label>
                            <fomantic-dropdown v-model="design.h2.fontfamily" :options="allFonts" :custom-fonts="design.customFonts" :manual-fonts="manualFonts" :system-fonts="systemFonts"></fomantic-dropdown>
                          </div>
                          <div class="fields">
                            <div class="field">
                              <label>Stil</label>
                              <div class="ui icon inverted buttons">
                                <button class="ui button" :class="{ blue: design.h2.bold }"  v-on:click.prevent="toggleH2Bold()">
                                  <i class="bold icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: design.h2.italic }"  v-on:click.prevent="toggleH2Italic()">
                                  <i class="italic icon"></i>
                                </button>
                                <button class="ui button" :class="{ blue: design.h2.fontvariant === 'small-caps' }" v-on:click.prevent="toggleH2Variant()" title="Kapitälchen">
                                  <span style="font-variant: small-caps; font-weight: bold;">Aa</span>
                                </button>
                              </div>
                            </div>
                            <div class="field">
                              <label>Umwandlung</label>
                              <div class="ui small basic inverted icon buttons">
                                <button class="ui button" :class="{ blue: design.h2.texttransform === 'none' }" v-on:click.prevent="design.h2.texttransform = 'none'" title="Normal">Aa</button>
                                <button class="ui button" :class="{ blue: design.h2.texttransform === 'uppercase' }" v-on:click.prevent="design.h2.texttransform = 'uppercase'" title="GROSS">AA</button>
                                <button class="ui button" :class="{ blue: design.h2.texttransform === 'lowercase' }" v-on:click.prevent="design.h2.texttransform = 'lowercase'" title="klein">aa</button>
                                <button class="ui button" :class="{ blue: design.h2.texttransform === 'capitalize' }" v-on:click.prevent="design.h2.texttransform = 'capitalize'" title="Erster Groß">Ab</button>
                              </div>
                            </div>
                            <div class="field">
                              <label>Dicke</label>
                              <input type="text" v-model="design.h2.fontweight" placeholder="800" style="width: 80px;">
                            </div>
                            <div class="field">
                              <label>Größe (vh)</label>
                              <input type="number" step="0.1" v-model="design.h2.fontsize" style="width: 80px;">
                            </div>
                            <div class="four wide field">
                              <color-picker v-model="design.h2.color" label="Schriftfarbe Titel"></color-picker>
                            </div>
                          </div>
            
                                        <h4 class="ui dividing header inverted">Eigene Schriftarten (Base64)</h4>
                            <div class="field">

                              <div class="ui segment" 

                                   style="border: 2px dashed #444; background: #1b1c1d; padding: 20px; text-align: center; cursor: pointer;"

                                   @dragover.prevent @drop.prevent="handleFontDrop"

                                   @click="addCustomFont">
                  <i class="huge upload icon" style="color: #555;"></i>
                  <p style="margin-top: 10px; color: #888;">Schriftarten hierher ziehen oder klicken (.ttf, .otf, .woff)</p>
                </div>
                
                <div class="ui middle aligned divided list inverted" style="margin-top: 10px;">
                  <div v-for="(font, index) in design.customFonts" :key="index" class="item" style="padding: 10px 0;">
                    <div class="right floated content">
                      <div class="ui mini inverted basic blue button" @click="applyFontToH1(font.name)">Name</div>
                      <div class="ui mini inverted basic green button" @click="applyFontToH2(font.name)">Titel</div>
                      <div class="ui mini inverted red icon button" @click="removeCustomFont(index)"><i class="trash icon"></i></div>
                    </div>
                    <i class="font icon"></i>
                    <div class="content">
                      <div class="header" :style="{ fontFamily: font.name }">{{ font.name }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <h4 class="ui dividing header inverted">Unified CSS Editor</h4>
              <div class="field">
                <css-editor v-model="design.unifiedCss"></css-editor>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="ui tab segment" data-tab="animation">
        <div class="row" style="margin-top: 20px;">
          <div class="col">
            <h2>Animation Editor</h2>
          </div>
          
          <!-- Presets / Templates -->
          <div class="col" style="margin-top:20px;">
            <h4 class="ui dividing header inverted">Vorlagen laden</h4>
            <div class="ui inverted buttons small">
              <button class="ui button" v-on:click.prevent="loadPreset('fade')">fade</button>
              <button class="ui button" v-on:click.prevent="loadPreset('slideleft')">slideleft</button>
              <button class="ui button" v-on:click.prevent="loadPreset('slideright')">slideright</button>
              <button class="ui button" v-on:click.prevent="loadPreset('slideup')">slideup</button>
              <button class="ui button" v-on:click.prevent="loadPreset('slideup_textdelay')">slideup textdelay</button>
            </div>
          </div>
        </div>

        <div v-if="animation.type == 'structured'" class="row" style="margin-top: 40px;">
          <!-- SHOW TIMELINE -->
          <div class="col">
            <h3 class="ui header inverted"><i class="eye icon"></i> Anzeigen (Fade In)</h3>
            <div class="ui segment inverted timeline-container">
              <div v-for="(step, index) in animation.show" :key="'show'+index" class="animation-step-card inverted">
                <div class="card-header">
                  <span class="step-num">{{index + 1}}</span>
                  <span class="step-title">{{ getFriendlyName(step.selector) }}</span>
                  <i class="trash alternate outline red icon delete-btn" @click.stop="removeAnimationStep('show', index)"></i>
                </div>
                <div class="card-body">
                  <div class="info-line"><i class="clock outline icon"></i> {{step.duration}}ms</div>
                  <div class="effects-line">
                    <i class="eye icon" v-if="step.properties.opacity !== undefined" title="Deckkraft"></i>
                    <i class="arrows alternate icon" v-if="getMotionXType(step) !== 'none' || getMotionYType(step) !== 'none'" title="Bewegung"></i>
                    <i class="expand icon" v-if="step.properties.scale !== undefined" title="Größe"></i>
                    <i class="tint icon" v-if="step.properties.backgroundColor !== undefined || step.properties.color !== undefined" title="Farbe"></i>
                    <i class="square outline icon" v-if="step.properties.borderRadius !== undefined || step.properties.borderWidth !== undefined" title="Ecken & Rahmen"></i>
                    <i class="font icon" v-if="step.properties.fontSize !== undefined" title="Text"></i>
                  </div>
                </div>
                <button class="ui mini fluid blue inverted button" @click="openStepEditor('show', index)"><i class="edit icon"></i> Edit</button>
              </div>
              <button class="ui circular icon green inverted big button add-step-btn" @click="addAnimationStep('show')"><i class="plus icon"></i></button>
            </div>

            <h3 class="ui header inverted" style="margin-top: 40px;"><i class="eye slash icon"></i> Ausblenden (Fade Out)</h3>
            <div class="ui segment inverted timeline-container">
              <div v-for="(step, index) in animation.hide" :key="'hide'+index" class="animation-step-card inverted">
                <div class="card-header">
                  <span class="step-num">{{index + 1}}</span>
                  <span class="step-title">{{ getFriendlyName(step.selector) }}</span>
                  <i class="trash alternate outline red icon delete-btn" @click.stop="removeAnimationStep('hide', index)"></i>
                </div>
                <div class="card-body">
                  <div class="info-line"><i class="clock outline icon"></i> {{step.duration}}ms</div>
                  <div class="effects-line">
                    <i class="eye icon" v-if="step.properties.opacity !== undefined" title="Deckkraft"></i>
                    <i class="arrows alternate icon" v-if="getMotionXType(step) !== 'none' || getMotionYType(step) !== 'none'" title="Bewegung"></i>
                    <i class="expand icon" v-if="step.properties.scale !== undefined" title="Größe"></i>
                    <i class="tint icon" v-if="step.properties.backgroundColor !== undefined || step.properties.color !== undefined" title="Farbe"></i>
                    <i class="square outline icon" v-if="step.properties.borderRadius !== undefined || step.properties.borderWidth !== undefined" title="Ecken & Rahmen"></i>
                    <i class="font icon" v-if="step.properties.fontSize !== undefined" title="Text"></i>
                  </div>
                </div>
                <button class="ui mini fluid blue inverted button" @click="openStepEditor('hide', index)"><i class="edit icon"></i> Edit</button>
              </div>
              <button class="ui circular icon green inverted big button add-step-btn" @click="addAnimationStep('hide')"><i class="plus icon"></i></button>
            </div>
          </div>
        </div>
      </div>

      <!-- STEP EDITOR MODAL -->
      <div class="ui inverted modal" id="step-modal">
        <div class="header inverted" style="background: #1b1c1d; border-bottom: 1px solid #333;">
          <i class="magic icon"></i> Effekt bearbeiten: {{ editingStep ? getFriendlyName(editingStep.step.selector) : '' }}
        </div>
        <div class="content inverted scrollable" style="background: #1b1c1d; max-height: 70vh; overflow-y: auto;">
          <div v-if="editingStep" class="ui form inverted small">
            
            <div class="two fields">
              <div class="field">
                <label>Ziel-Element</label>
                <select v-model="editingStep.step.selector" class="ui dropdown inverted selection">
                  <option value=".bauchbinde-instance">Ganze Bauchbinde</option>
                  <option value=".bb-box">Box</option>
                  <option value=".text">Text-Bereich</option>
                  <option value="h1">Name (H1)</option>
                  <option value="h2">Titel (H2)</option>
                </select>
              </div>
              <div v-if="editingStep.step.selector === 'h1' || editingStep.step.selector === 'h2'" class="field">
                <label>Text-Aufteilung (Split)</label>
                <select v-model="editingStep.step.split" class="ui dropdown inverted selection">
                  <option :value="undefined">Ganze Zeile</option>
                  <option value="chars">Buchstaben</option>
                  <option value="words">Wörter</option>
                </select>
              </div>
            </div>

            <div class="three fields">
              <div class="field"><label>Dauer (ms)</label><input type="number" class="inverted" v-model="editingStep.step.duration"></div>
              <div class="field"><label>Verzögerung (ms)</label><input type="number" class="inverted" v-model="editingStep.step.delay"></div>
              <div class="field">
                <label>Kurve</label>
                <select v-model="editingStep.step.easing" class="ui dropdown inverted selection">
                  <option value="linear">linear</option>
                  <option value="easeInQuad">easeInQuad</option>
                  <option value="easeOutQuad">easeOutQuad</option>
                  <option value="easeInOutQuad">easeInOutQuad</option>
                  <option value="easeInCirc">easeInCirc</option>
                  <option value="easeOutCirc">easeOutCirc</option>
                  <option value="easeInOutCirc">easeInOutCirc</option>
                  <option value="easeInBack">easeInBack</option>
                  <option value="easeOutBack">easeOutBack</option>
                  <option value="easeOutBounce">easeOutBounce</option>
                </select>
              </div>
            </div>

            <div class="ui accordion inverted structured-editor-acc" style="border: 1px solid #333; padding: 10px; border-radius: 4px;">
              
              <!-- VISIBILITY & SCALE -->
              <div class="title active"><i class="dropdown icon"></i> Sichtbarkeit & Größe</div>
              <div class="content active">
                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.opacity !== undefined" @change="$event.target.checked ? editingStep.step.properties.opacity = (editingStep.phase==='show'?[0, getDesignValueForEditor(editingStep.step.selector, 'opacity')]:[getDesignValueForEditor(editingStep.step.selector, 'opacity'), 0]) : delete editingStep.step.properties.opacity"><label>Deckkraft</label></div></div>
                <div v-if="editingStep.step.properties.opacity !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="number" step="0.1" class="inverted" v-model="editingStep.step.properties.opacity[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'opacity')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'opacity', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="number" step="0.1" class="inverted" v-model="editingStep.step.properties.opacity[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'opacity')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'opacity', $event.target.value)"></div>
                </div>
                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.scale !== undefined" @change="$event.target.checked ? editingStep.step.properties.scale = (editingStep.phase==='show'?[0, 1]:[1, 0]) : delete editingStep.step.properties.scale"><label>Größe (Scale)</label></div></div>
                <div v-if="editingStep.step.properties.scale !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="number" step="0.1" class="inverted" v-model="editingStep.step.properties.scale[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'scale')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'scale', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="number" step="0.1" class="inverted" v-model="editingStep.step.properties.scale[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'scale')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'scale', $event.target.value)"></div>
                </div>
              </div>

              <!-- MOTION X & Y -->
              <div class="title"><i class="dropdown icon"></i> Bewegung (X & Y)</div>
              <div class="content">
                <div class="field">
                  <label>X-Achse</label>
                  <select :value="getMotionXType(editingStep.step)" @change="setStepProperty(editingStep.step, 'motion_x_type', $event.target.value)" class="ui mini dropdown inverted selection">
                    <option value="none">-- Keine --</option>
                    <option value="translateX">Transform X (vw)</option>
                    <option value="left">Position Links (vw)</option>
                  </select>
                  <div v-if="getMotionXType(editingStep.step) !== 'none'" class="fields mini-fields inverted">
                    <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties[getMotionXType(editingStep.step)][0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, getMotionXType(editingStep.step))" @input="updateDesignValueFromAnimation(editingStep.step.selector, getMotionXType(editingStep.step), $event.target.value)"></div>
                    <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties[getMotionXType(editingStep.step)][1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, getMotionXType(editingStep.step))" @input="updateDesignValueFromAnimation(editingStep.step.selector, getMotionXType(editingStep.step), $event.target.value)"></div>
                  </div>
                </div>
                <div class="field">
                  <label>Y-Achse</label>
                  <select :value="getMotionYType(editingStep.step)" @change="setStepProperty(editingStep.step, 'motion_y_type', $event.target.value)" class="ui mini dropdown inverted selection">
                    <option value="none">-- Keine --</option>
                    <option value="translateY">Transform Y (vh)</option>
                    <option value="top">Position Oben (vh)</option>
                  </select>
                  <div v-if="getMotionYType(editingStep.step) !== 'none'" class="fields mini-fields inverted">
                    <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties[getMotionYType(editingStep.step)][0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, getMotionYType(editingStep.step))" @input="updateDesignValueFromAnimation(editingStep.step.selector, getMotionYType(editingStep.step), $event.target.value)"></div>
                    <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties[getMotionYType(editingStep.step)][1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, getMotionYType(editingStep.step))" @input="updateDesignValueFromAnimation(editingStep.step.selector, getMotionYType(editingStep.step), $event.target.value)"></div>
                  </div>
                </div>
                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.rotate !== undefined" @change="$event.target.checked ? editingStep.step.properties.rotate = [-45, 0] : delete editingStep.step.properties.rotate"><label>Rotation</label></div></div>
                <div v-if="editingStep.step.properties.rotate !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="number" class="inverted" v-model="editingStep.step.properties.rotate[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'rotate')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'rotate', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="number" class="inverted" v-model="editingStep.step.properties.rotate[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'rotate')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'rotate', $event.target.value)"></div>
                </div>
              </div>

              <!-- SPACING (MARGIN/PADDING) -->
              <div class="title"><i class="dropdown icon"></i> Abstände (Margin & Padding)</div>
              <div class="content">
                <div v-for="prop in ['marginTop','marginRight','marginBottom','marginLeft','paddingTop','paddingRight','paddingBottom','paddingLeft']" :key="prop" style="margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 10px;">
                  <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties[prop] !== undefined" @change="$event.target.checked ? editingStep.step.properties[prop] = ['0px', getDesignValueForEditor(editingStep.step.selector, prop)] : delete editingStep.step.properties[prop]"><label>{{prop}}</label></div></div>
                  <div v-if="editingStep.step.properties[prop] !== undefined" class="fields mini-fields inverted">
                    <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties[prop][0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, prop)" @input="updateDesignValueFromAnimation(editingStep.step.selector, prop, $event.target.value)"></div>
                    <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties[prop][1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, prop)" @input="updateDesignValueFromAnimation(editingStep.step.selector, prop, $event.target.value)"></div>
                  </div>
                </div>
              </div>

              <!-- COLORS & BORDERS (DIV ONLY) -->
              <div v-if="!['h1','h2'].includes(editingStep.step.selector)" class="title"><i class="dropdown icon"></i> Farben & Rahmen (Box)</div>
              <div v-if="!['h1','h2'].includes(editingStep.step.selector)" class="content">
                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.backgroundColor !== undefined" @change="$event.target.checked ? editingStep.step.properties.backgroundColor = ['#ffffff', getDesignValueForEditor(editingStep.step.selector, 'backgroundColor')] : delete editingStep.step.properties.backgroundColor"><label>Hintergrundfarbe</label></div></div>
                <div v-if="editingStep.step.properties.backgroundColor !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties.backgroundColor[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'backgroundColor')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'backgroundColor', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties.backgroundColor[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'backgroundColor')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'backgroundColor', $event.target.value)"></div>
                </div>
                
                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.borderColor !== undefined" @change="$event.target.checked ? editingStep.step.properties.borderColor = ['#ffffff', getDesignValueForEditor(editingStep.step.selector, 'borderColor')] : delete editingStep.step.properties.borderColor"><label>Rahmenfarbe</label></div></div>
                <div v-if="editingStep.step.properties.borderColor !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties.borderColor[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'borderColor')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'borderColor', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties.borderColor[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'borderColor')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'borderColor', $event.target.value)"></div>
                </div>

                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.borderWidth !== undefined" @change="$event.target.checked ? editingStep.step.properties.borderWidth = ['0px', getDesignValueForEditor(editingStep.step.selector, 'borderWidth')] : delete editingStep.step.properties.borderWidth"><label>Rahmendicke</label></div></div>
                <div v-if="editingStep.step.properties.borderWidth !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties.borderWidth[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'borderWidth')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'borderWidth', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties.borderWidth[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'borderWidth')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'borderWidth', $event.target.value)"></div>
                </div>

                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" v-model="editingStep.step.lineDraw"><label>Border als Linie zeichnen</label></div></div>
              </div>

              <!-- TEXT STIL (H1/H2 ONLY) -->
              <div v-if="['h1','h2'].includes(editingStep.step.selector)" class="title"><i class="dropdown icon"></i> Text-Stil & Farbe</div>
              <div v-if="['h1','h2'].includes(editingStep.step.selector)" class="content">
                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.color !== undefined" @change="$event.target.checked ? editingStep.step.properties.color = ['#ffffff', getDesignValueForEditor(editingStep.step.selector, 'color')] : delete editingStep.step.properties.color"><label>Schriftfarbe</label></div></div>
                <div v-if="editingStep.step.properties.color !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties.color[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'color')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'color', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties.color[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'color')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'color', $event.target.value)"></div>
                </div>

                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.fontSize !== undefined" @change="$event.target.checked ? editingStep.step.properties.fontSize = ['1vh', getDesignValueForEditor(editingStep.step.selector, 'fontSize')] : delete editingStep.step.properties.fontSize"><label>Textgröße</label></div></div>
                <div v-if="editingStep.step.properties.fontSize !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties.fontSize[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'fontSize')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'fontSize', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties.fontSize[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'fontSize')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'fontSize', $event.target.value)"></div>
                </div>

                <div class="inline field"><div class="ui checkbox inverted tiny"><input type="checkbox" :checked="editingStep.step.properties.width !== undefined" @change="$event.target.checked ? editingStep.step.properties.width = ['0vw', getDesignValueForEditor(editingStep.step.selector, 'width')] : delete editingStep.step.properties.width"><label>Textbreite</label></div></div>
                <div v-if="editingStep.step.properties.width !== undefined" class="fields mini-fields inverted">
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'hide'}"><label>{{editingStep.phase==='show'?'Start':'Design'}}</label><input v-if="editingStep.phase==='show'" type="text" class="inverted" v-model="editingStep.step.properties.width[0]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'width')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'width', $event.target.value)"></div>
                  <div class="field" :class="{'design-state-field': editingStep.phase === 'show'}"><label>{{editingStep.phase==='hide'?'Ziel':'Design'}}</label><input v-if="editingStep.phase==='hide'" type="text" class="inverted" v-model="editingStep.step.properties.width[1]"><input v-else type="text" class="inverted" :value="getDesignValueForEditor(editingStep.step.selector, 'width')" @input="updateDesignValueFromAnimation(editingStep.step.selector, 'width', $event.target.value)"></div>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div class="actions inverted" style="background: #1b1c1d; border-top: 1px solid #333;">
          <div class="ui positive fluid button">Fertig</div>
        </div>
      </div>

      <div class="ui tab segment" data-tab="info">
        <div class="row" style="margin-top: 20px;">
          <div class="col">
            <h2>infos</h2>
            <div class="ui inverted segment">
              <h3>Bauchbinder einbinden</h3>
              <p>Link für OBS Browser Quelle: <a href="http://127.0.0.1:5001" v-on:click.prevent="require('electron').shell.openExternal('http://127.0.0.1:5001');">http://127.0.0.1:5001</a></p>
              <h3>Key and Fill per HDMI</h3>
              <p>Vollbild für Key und Fill Fenster: Doppelclick ins Fenster</p>
              <h3>Shortcuts und Companion Einbindung</h3>
              <p>Shortcuts: [STRG/CTRL]+[ALT/OPTION]+[0-9] wobei 0 ausblenden, und 1-9 einblenden nach ID ist</p>
              
              <div class="ui divider inverted"></div>
              
              <h4>Bitfocus Companion (Empfohlen)</h4>
              <p>Für die beste Integration nutze unser natives Companion Modul. Einfach herunterladen und in den Developer-Ordner von Companion entpacken.</p>
              <a href="downloads/bauchbinder-companion.zip" class="ui icon label labeled purple button" download>
                <i class="download icon"></i>
                Companion Modul herunterladen
              </a>
              
              <h4 style="margin-top: 20px;">Legacy: Generic HTTP</h4>
              <p>Compagnion Anbindung über "Generic HTTP Modul":<br>BaseURL: http://localhost:5001/v1/<br>Button Action anzeigen: [POST] "show/X" wobei X die ID des Eintrags ist z.B. "show/1"<br>Button Action ausblenden: [POST] "hide"</p>
              <p></p>
              <h3>Bleibe auf dem neuesten Stand</h3>
              <p>Bauchbinder auf GitHub:  <a v-on:click.prevent="require('electron').shell.openExternal('https://github.com/stckl/bauchbinder');">https://github.com/stckl/bauchbinder</a></p>
              <p></p>
              <h3>Helferlein für CSS</h3>
              <p>Flexbox Layouting: <a v-on:click.prevent="require('electron').shell.openExternal('https://css-tricks.com/snippets/css/a-guide-to-flexbox/');">https://css-tricks.com/snippets/css/a-guide-to-flexbox/</a></p>
              <p>Farbverlauf: <a v-on:click.prevent="require('electron').shell.openExternal('https://cssgradient.io');">https://cssgradient.io</a></p>
              <p>SVGs einbinden: <a v-on:click.prevent="require('electron').shell.openExternal('https://yoksel.github.io/url-encoder/');">https://yoksel.github.io/url-encoder/</a></p>
              <p>Images einbinden: <a v-on:click.prevent="require('electron').shell.openExternal('https://www.base64-image.de');">https://www.base64-image.de</a></p>
            </div>
          </div>
        </div>
      </div>

      <div class="row" style="margin-top: 50px;">
        <div class="col" style="clear: both; margin-top:20px;">
          <div class="ui divider"></div>

          <button class="ui right floated labeled icon inverted button" v-on:click="openFile">
            <i class="folder open icon"></i>
            öffnen
          </button>
          <button class="ui right floated labeled icon inverted button" v-on:click="saveFile">
            <i class="save icon"></i>
            speichern
          </button>
      
          <div class="ui floated buttons">
            <button class="ui labeled icon inverted teal button" v-on:click="openWinKey">
              <i class="window maximize outline icon"></i>
              key
            </button>
            <button class="ui icon inverted teal button" title="Fullscreen Key" v-on:click="toggleFullscreenKey">
              <i class="expand arrows alternate icon"></i>
            </button>
          </div>
          <div class="ui floated buttons" style="margin-left: 10px;">
            <button class="ui labeled icon inverted teal button" v-on:click="openWinFill">
              <i class="window maximize outline icon"></i>
              fill
            </button>
            <button class="ui icon inverted teal button" title="Fullscreen Fill" v-on:click="toggleFullscreenFill">
              <i class="expand arrows alternate icon"></i>
            </button>
          </div>
          <div style="clear:both; height: 30px;"></div>
        </div>
      </div>

      <!-- app end -->

      <!-- lower third modal -->
      <div class="ui inverted modal" id="entry-modal">
        <i class="close icon"></i>
        <div v-if="newentryid == null" class="header inverted">
          Neue Bauchbinde
        </div>
        <div v-else class="header inverted">
          Bauchbinde Nr. {{newentryid}}
        </div>
        <div class="content inverted" style="background: #1b1c1d;">
          <div class="row">
            <div class="col">
              <div style="margin-top: 10px;">
              <form class="ui inverted form" v-on:submit.prevent="addLowerthird">
                <div class="field">
                  <label>Name</label>
                  <input type="text" name="name" placeholder="Name" v-model="newname">
                </div>
                <div class="field">
                  <label>Titel</label>
                  <input type="text" name="title" placeholder="Titel" v-model="newtitle">
                </div>
              </form>
              </div>
            </div>        
          </div>
        </div>
        <div class="actions inverted" style="background: #1b1c1d;">
          <div v-if="newentryid != null" class="ui icon inverted red deny button" v-on:click="deleteLowerthird(newentryid)"><i class="trash icon"></i></div>
          <div class="ui inverted black deny button">abbrechen</div>
          <div v-if="newentryid == null" class="ui inverted green right labeled icon button" v-on:click="addLowerthird">hinzufügen <i class="plus icon"></i></div>
          <div class="ui inverted positive right labeled icon button" v-on:click="addLowerthird">
            speichern und beenden
            <i class="checkmark icon"></i>
          </div>
        </div>
      </div>

      <div class="copy">2026 - with ❤️ from mstockle.de version: {{ appversion }}</div>

      <!-- conflict resolution modal -->
      <div class="ui inverted modal" id="conflict-modal">
        <div class="header inverted">CSS Duplikate gefunden</div>
        <div class="content inverted" style="background: #1b1c1d;">
          <p>Die geladene Datei enthält Design-Einstellungen, die sowohl in der GUI als auch im Custom-CSS definiert sind. Bitte wähle für jeden Konflikt, welcher Wert behalten werden soll:</p>
          <div class="ui middle aligned divided list inverted">
            <div v-for="(c, index) in cssConflicts" :key="index" class="item" style="padding: 15px 0;">
              <div class="content">
                <div class="header" style="color: #adff2f;">Selektor: {{ c.selector }} &raquo; Eigenschaft: {{ c.property }}</div>
                <div class="description" style="margin-top: 10px;">
                  <div class="ui two column grid">
                    <div class="column">
                      <div class="ui segment inverted">
                        <div class="ui top attached label">GUI Standard</div>
                        <code>{{ c.guiValue }}</code>
                        <button class="ui fluid basic inverted button" style="margin-top: 10px;" @click="resolveConflict(index, 'gui')">Behalten</button>
                      </div>
                    </div>
                    <div class="column">
                      <div class="ui segment inverted secondary">
                        <div class="ui top attached label teal">Custom CSS (Empfohlen)</div>
                        <code>{{ c.customValue }}</code>
                        <button class="ui fluid teal button" style="margin-top: 10px;" @click="resolveConflict(index, 'custom')">Behalten</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <script type="module" src="src/renderer/main.js"></script>
  </body>
</html>